import macros
import ../../omni

ins 1
outs 1

expandMacros:
    struct Dummy[T]:
        T a

    struct Phasor[T]:
        float phase
        Dummy[T] phase2


expandMacros:
    def newPhasor(float a = 2.3, b = 0, c = 0, float d, e):
        float y
        float z = 0.0
        return Phasor.new(y, Dummy.new(a + z))

expandMacros:
    init:
        phasor = newPhasor(d = 0.2, e = false)

expandMacros:
    perform:
        float increment = in1 / samplerate
        
        sample:
            out1 = phasor.phase
            phasor.phase += increment
            phasor.phase = phasor.phase mod 1.0